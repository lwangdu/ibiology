jQuery(document).ready(function(t){function e(t){var e=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return e.test(t)}function i(t,e,i){if(0===i)document.cookie=t+"="+e+";path=/;";else{var a=new Date;a.setTime(a.getTime()+24*i*60*60*1e3),document.cookie=t+"="+e+";path=/;expires="+a.toUTCString()}}function a(t){var e="; "+document.cookie,i=e.split("; "+t+"=");return 2===i.length?i.pop().split(";").shift():!1}t(document).on("submit",".fca_eoi_form",function(o){o.preventDefault();var n,r=t(this),c=t("[name=email]",r),l=t("[name=name]:visible",r),s=l.val(),_=c.val(),d=r.data("fca_eoi_list_id"),f=t("[type=submit]",r),p=!1,m=r.data("fca_eoi_thank_you_mode"),u=r.data("fca_eoi_thank_you_page"),v=r.data("fca_eoi_success_cookie_duration"),h=r.data("fca_eoi_sub_msg"),y=!1,b=t("[name=fca_eoi_form_id]",r).val();if(t("[name=email], [name=name]",r).not(".tooltipstered").each(function(){var e=t(this),i=.8*e.width();e.tooltipster({contentAsHTML:!0,fixedWidth:i,minWidth:i,maxWidth:i,trigger:"none",theme:["tooltipster-borderless","tooltipster-optin-cat"]})}),t("[name=email], [name=name]",t(this)).focus(function(){var e=t(this),i=t("[type=submit]",e.closest(".fca_eoi_form")),a=i.data("fca_eoi_initial_val");"undefined"!=typeof a&&i.val(a),t(this).tooltipster("hide")}),f.data("fca_eoi_initial_val")?n=f.data("fca_eoi_initial_val"):(n=f.val(),f.data("fca_eoi_initial_val",n)),f.val(n),fcaEoiScriptData.invalid_email=r.find(".fca_eoi_error_texts_email").val(),fcaEoiScriptData.field_required=r.find(".fca_eoi_error_texts_required").val(),_&&e(_)||(c.tooltipster("content",_?fcaEoiScriptData.invalid_email:fcaEoiScriptData.field_required),c.tooltipster("show"),f.val("✗ "+n),y=!0),l.length&&!s&&(l.tooltipster("content",fcaEoiScriptData.field_required),l.tooltipster("show"),f.val("✗ "+n),y=!0),y)return!1;f.val(h),f.click(function(t){t.preventDefault()}),f.attr("style","cursor: default");var g=jstz.determine();t.ajax({url:fcaEoiScriptData.ajax_url,data:{email:_,name:s,action:"fca_eoi_subscribe",list_id:d,form_id:b,nonce:fcaEoiScriptData.nonce,timezone:g.name()},type:"POST",datatype:"text",timeout:15e3}).done(function(e){if("✓"===e){f.val(e+" "+n),i("fca_eoi_success_"+b,Math.floor(Date.now()/1e3),v);var o=JSON.parse(a("fca_eoi_active_optins"));Array.isArray(o)||(o=[]);var r=o.indexOf(b);-1!==r&&o.splice(r,1),i("fca_eoi_active_optins",JSON.stringify(o))}else f.val(e);"ajax"===m&&"✓"===e?(clearInterval(p),u&&"✓"===e&&(tooltipWidth=f.width(),f.tooltipster({contentAsHTML:!0,trigger:"none",fixedWidth:tooltipWidth,minWidth:tooltipWidth,maxWidth:tooltipWidth,arrow:!1,theme:["tooltipster-borderless","tooltipster-optin-cat"]}),f.tooltipster("content",u),f.tooltipster("show"),c.prop("disabled",!0),l.prop("disabled",!0),t(".tooltipster-content").css("background-color","#148544"))):"✓"===e&&(window.location.href=u)})})});